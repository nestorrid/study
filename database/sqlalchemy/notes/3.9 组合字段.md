# 3.9 组合字段

可以将多个数据库字段组合成为一个对象字段



```python
import dataclasses
    
from sqlalchemy.orm import DeclarativeBase, Mapped
from sqlalchemy.orm import composite, mapped_column

@dataclasses.dataclass
class Point:
    x: int
    y: int

class Base(DeclarativeBase):
    pass


class Vertex(Base):
    __tablename__ = "vertices"

    id: Mapped[int] = mapped_column(primary_key=True)

    start: Mapped[Point] = composite(mapped_column("x1"), mapped_column("y1"))
    end: Mapped[Point] = composite(mapped_column("x2"), mapped_column("y2"))

    def __repr__(self):
        return f"Vertex(start={self.start}, end={self.end})"
      
@dataclasses.dataclass
class FullName:
    firstname: str
    lastname: str


class User(Base):

    __tablename__ = 'users'

    id: Mapped[int] = mapped_column(primary_key=True)

    fullname: Mapped[FullName] = composite(
        mapped_column('firstname', String(15)), mapped_column('lastname', String(15)))      
```



如果使用了组合字段, 那么便可以在对象操作时直接使用组合字段内进行对象的初始化



```python
v = Vertex(start=Point(3, 4), end=Point(5, 6))
session.add(v)
session.commit()

"""
BEGIN (implicit)
INSERT INTO vertices (x1, y1, x2, y2) VALUES (?, ?, ?, ?)
[generated in ...] (3, 4, 5, 6)
COMMIT
"""
```

